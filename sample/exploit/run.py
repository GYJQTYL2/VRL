#! /usr/bin/python
#coding:utf-8
import os
import sys
sys.path.append("../..")
from modules import exploit

class Exploit(exploit.VRL_Exploit):
    def __init__(self):
        '''Add information of your exploit here'''
        self.name = 'Exploit Name'
        self.info = \
'''Exploit Name : XXX
Exploit abstract : XXX
Author : XXX
Support change payload : True
'''
        self.options = {'dIP' : '127.0.0.1',
                      'port' : '12345',
                      'aslr' : 'False'}
        self.vulnerability = 'Supported Vulnerability Name'
        self.default_payload = 'payload1'
        self.supported_payload = ['payload1', 'payload2']
        self.payload_requirement = \
'''architecture : x86
max length : 200
NULL byte : allow
'''

    def run(self):
        '''Run your exploit here, if this script could success, the VRL can run it.
        When the exploit run, follow the options.'''
        import socket
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((self.options['dIP'], int(self.options['port'])))
        data = 'A' * 100 + self.payload
        s.send(data)
        s.close()
        print "Exploit Finished."


'''Bellowing is default, simply ignore it.'''
if __name__ == "__main__":
    if '__init__.py' not in os.listdir(os.curdir):
        os.mknod('__init__.py')
    exp = Exploit()
    print 'Exploit: ',exp.name,' \n'
    print 'Checking:\n'
    if exp.check():
        print 'Running:\n'
        exp.run()

